(()=>{var Z=(h,e,t)=>{if(!e.has(h))throw TypeError("Cannot "+t)};var x=(h,e,t)=>{if(e.has(h))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(h):e.set(h,t)};var E=(h,e,t)=>(Z(h,e,"access private method"),t);var m=class{static isValid(e){return e instanceof HTMLElement||e instanceof SVGElement}static assertValid(e){if(!this.isValid(e))throw new Error("Not an SVG/HTMLElement")}};var N=class{querySelectorAll(e){return document.querySelectorAll(e)}querySelector(e){return document.querySelector(e)}};var D,W,V=class{constructor(){x(this,D)}build(e){let t=e.filter(l=>l.type==="tag"&&l.level<=0),r=e.filter(l=>l.type==="id"&&l.level<=0),i=e.filter(l=>l.type==="class"&&l.level<=0),o=e.filter(l=>l.type==="attr"&&l.level<=0),n=e.filter(l=>l.type==="pseudo"&&l.level<=0),s=e.filter(l=>l.level>0),c=t.map(l=>l.selector).join("")+r.map(l=>l.selector).join("")+i.map(l=>l.selector).join("")+o.map(l=>l.selector).join("")+n.map(l=>l.selector).join("");if(c===""&&(c="*"),s.length>0){let l=new Map;for(let a of s)l.has(a.level)||l.set(a.level,[]),l.get(a.level).push(a);let u=Array.from(l.keys()).sort((a,f)=>a-f),p=0;for(let a of u){let f=E(this,D,W).call(this,l.get(a));a===p+1?c=f+" > "+c:c=f+" "+c,p=a}}return c}};D=new WeakSet,W=function(e){let t=e.filter(s=>s.type==="tag"),r=e.filter(s=>s.type==="id"),i=e.filter(s=>s.type==="class"),o=e.filter(s=>s.type==="attr"),n=e.filter(s=>s.type==="pseudo");return t.map(s=>s.selector).join("")+r.map(s=>s.selector).join("")+i.map(s=>s.selector).join("")+o.map(s=>s.selector).join("")+n.map(s=>s.selector).join("")};var R=class{constructor(e,t){this.domService=e,this.selectorBuilder=t}getValue(e,t){let r=this.selectorBuilder.build(t);if(r==="")return 1/0;let i=this.domService.querySelectorAll(r),o=i.length;if(o===0)return console.error("Empty selector: ",r,t),1/0;let n=Array.from(i);for(let s of e)if(!n.includes(s))return console.error("Element is missing from selector results: ",r,t),1/0;return o}findBest(e,t){t.sort((n,s)=>n.cost-s.cost);let r=[],i=1/0,o=e.length;for(let n=16;n>=1;n=n/2){let s=!0;for(;s;){s=!1;let c=[...r],l=i,u=[...r],p=1/0;for(let a of t)if(!u.includes(a)&&!(r.length===0&&a.level>0)&&(u=[...r,a],p=this.getValue(e,u),l-p>=n&&(l=p,c=[...u]),p===o))break;if(i-l>0){if(r=[...c],i=l,i===o)return r;s=!0}if(l===o)break}}return r}};var M=class{constructor(e,t){this.domService=e,this.selectorBuilder=t}matches(e,t){let r=this.selectorBuilder.build(t);if(r==="")return!1;let i=this.domService.querySelectorAll(r);return Array.from(i).includes(e)}findMinimalNonMatchingSet(e,t){let r=[...t];for(let i=r.length-1;i>=0;i--){let o=r.filter((n,s)=>s!==i);this.matches(e,o)||(r=o)}return r}};var $=class{constructor(e,t){this.domService=e,this.selectorBuilder=t,this.debugOptimizer=new M(e,t)}getValue(e,t){let r=this.selectorBuilder.build(t);if(r==="")return null;let i=this.domService.querySelectorAll(r),o=i.length;if(o===0)return null;let n=Array.from(i);for(let c of e)if(!n.includes(c))return console.error("Element is missing from selector results: ",r,t),null;let s=t.reduce((c,l)=>c+l.cost,0);return{count:o,cost:s}}findBest(e,t){let r=e.length,i=[...t],o=this.getValue(e,i),n=o?o.count:0;if(!o||o.count!==n){console.warn(`Top-down optimizer: All selectors combined do not produce a selector matching exactly ${r} element(s). Finding minimal non-matching subset for debugging.`);let l=this.debugOptimizer.findMinimalNonMatchingSet(e[0],i);return console.log("The problematic selector is this:",l,this.selectorBuilder.build(l)),i}let s=[...i].sort((l,u)=>u.cost-l.cost),c=!0;for(;c&&i.length>1;){c=!1;for(let l of s){if(!i.includes(l)||l.level===0&&l.type==="tag")continue;let u=i.filter(a=>a!==l),p=this.getValue(e,u);if(p&&p.count===n){i=u,o=p,c=!0;break}}}return i}};var b=["*lottie*","selector-generator"],_=["*-ng-*","ng-*","*tw-*","*[*px]*"],O=["id","style","*-ng-*","ng-*","*tw-*","xmlns*"];var j,Y,g=class{static matches(e,t){if(!e||!t||t.length===0)return!1;for(let r of t)if(E(this,j,Y).call(this,r).test(e))return!0;return!1}static filter(e,t){return!e||e.length===0||!t||t.length===0?e:e.filter(r=>!this.matches(r,t))}};j=new WeakSet,Y=function(e){let r="^"+e.replace(/[.+?^${}()|[\]\\]/g,"\\$&").replace(/\*/g,".*")+"$";return new RegExp(r)},x(g,j);var K=class{generate(e){for(let o of e)m.assertValid(o);let t=[],r=e.map(o=>{let n=[];o.id!==""&&!g.matches(o.id,b)&&n.push({cost:0,level:0,type:"id",selector:"#"+CSS.escape(o.id)}),n.push({cost:2,level:0,type:"tag",selector:o.localName});for(let s=0,c=o.attributes;s<c.length;s++){let l=c.item(s).name;if(l==="class"){o.classList.forEach(u=>{g.matches(u,_)||n.push({cost:1,level:0,type:"class",selector:"."+CSS.escape(u)})});continue}g.matches(l,O)||n.push({cost:3,level:0,type:"attr",selector:"["+CSS.escape(l)+"]"})}return n});if(r.length===0)return t;let i=r[0];for(let o of i)r.every(s=>s.some(c=>c.level===o.level&&c.type===o.type&&c.selector===o.selector))&&t.push(o);return t}};var q=class{constructor(e){this.targetElement=e}collectExtraIds(e){let t=[];for(let r=0;r<e.length;r++){let i=e[r];if(i===this.targetElement)continue;let o=i.getAttribute("id");o!==null&&!g.matches(o,b)&&t.push(CSS.escape(o))}return t}collectExtraClasses(e){let t=[];for(let r=0;r<e.length;r++){let i=e[r];i!==this.targetElement&&i.classList.forEach(o=>{!this.targetElement.classList.contains(o)&&!t.includes(o)&&!g.matches(o,_)&&t.push(CSS.escape(o))})}return t}collectExtraAttributes(e){let t=[];for(let r=0;r<e.length;r++){let i=e[r];if(i===this.targetElement)continue;let o=i.attributes;for(let n=0;n<o.length;n++){let s=o.item(n);!this.targetElement.hasAttribute(s.name)&&!t.includes(s.name)&&!g.matches(s.name,O)&&t.push(CSS.escape(s.name))}}return t}collectAll(e){return{extraIds:this.collectExtraIds(e),extraClasses:this.collectExtraClasses(e),extraAttributes:this.collectExtraAttributes(e)}}};var H=class{constructor(e,t,r){this.domService=e,this.localGenerator=t,this.selectorBuilder=r}generate(e){for(let o of e)m.assertValid(o);let t=[],r=e.map(o=>{let n=this.localGenerator.generate([o]),s=this.selectorBuilder.build(n),c=this.domService.querySelectorAll(s),l=[],u=new q(o),{extraIds:p,extraClasses:a,extraAttributes:f}=u.collectAll(c);for(let d=0;d<p.length;d++)l.push({cost:10,level:0,type:"pseudo",selector:":not(#"+p[d]+")"});for(let d=0;d<a.length;d++)l.push({cost:11,level:0,type:"pseudo",selector:":not(."+a[d]+")"});for(let d=0;d<f.length;d++)l.push({cost:13,level:0,type:"pseudo",selector:":not(["+f[d]+"])"});return l});if(r.length===0)return t;let i=r[0];for(let o of i)r.every(s=>s.some(c=>c.level===o.level&&c.type===o.type&&c.selector===o.selector))&&t.push(o);return t}};var B,F,z=class{constructor(e){x(this,B);this.localGenerator=e}generate(e){for(let o of e)m.assertValid(o);let t=[],r=e.map(o=>{let n=[];return E(this,B,F).call(this,o,0,n),n});if(r.length===0)return t;let i=r[0];for(let o of i)r.every(s=>s.some(c=>c.level===o.level&&c.type===o.type&&c.selector===o.selector))&&t.push(o);return t}};B=new WeakSet,F=function(e,t,r){let i=e.children,o=">*".repeat(t);if(i.length===0)return e.childNodes.length>0&&t===0?(r.push({cost:t*1+10+5+100,level:0,type:"pseudo",selector:":not(:has(>*))"}),r):(e.childNodes.length===0&&(r.push({cost:t*1+5+100,level:0,type:"pseudo",selector:t>0?`:has(${o}:empty)`:":empty"}),t>0&&r.push({cost:106,level:0,type:"pseudo",selector:":has(:empty)"})),r);r.push({cost:t*1+5+100,level:0,type:"pseudo",selector:t>0?`:has(${o}>*:nth-child(${i.length}):last-child)`:`:has(:nth-child(${i.length}):last-child)`}),t>0&&r.push({cost:106,level:0,type:"pseudo",selector:`:has(* :nth-child(${i.length}):last-child)`});for(let n=0;n<i.length;n++){let s=i[n],c=this.localGenerator.generate([s]);for(let l of c)r.push({cost:t*1+5+100+l.cost,level:0,type:"pseudo",selector:t>0?`:has(${o}>${l.selector})`:`:has(>${l.selector})`}),t>0&&r.push({cost:106+l.cost,level:0,type:"pseudo",selector:`:has(* ${l.selector})`});E(this,B,F).call(this,s,t+1,r)}};var k=class{constructor(e,t,r){this.domService=e,this.localGenerator=t,this.selectorBuilder=r}generate(e){for(let o of e)m.assertValid(o);let t=[],r=e.map(o=>{let n=[],s=this.localGenerator.generate([o]),c=this.selectorBuilder.build(s)+" *",l=this.domService.querySelectorAll(c),u=[],p=[];for(let a=0;a<l.length;a++){let f=l[a];if(o.contains(f))continue;let d=f.getAttribute("id");d!==null&&!g.matches(d,b)&&n.push({cost:115,level:0,type:"pseudo",selector:":not(:has(#"+CSS.escape(d)+"))"}),f.classList.forEach(v=>{!o.querySelector("."+CSS.escape(v))&&!u.includes(v)&&!g.matches(v,_)&&u.push(CSS.escape(v))});let Q=f.attributes;for(let v=0;v<Q.length;v++){let w=Q.item(v);!o.querySelector("["+CSS.escape(w.name)+"]")&&!p.includes(w.name)&&!g.matches(w.name,O)&&p.push(CSS.escape(w.name))}}for(let a=0;a<u.length;a++)n.push({cost:116,level:0,type:"pseudo",selector:":not(:has(."+u[a]+"))"});for(let a=0;a<p.length;a++)n.push({cost:118,level:0,type:"pseudo",selector:":not(:has(["+p[a]+"]))"});return n});if(r.length===0)return t;let i=r[0];for(let o of i)r.every(s=>s.some(c=>c.level===o.level&&c.type===o.type&&c.selector===o.selector))&&t.push(o);return t}};var U=class{constructor(e){this.localGenerator=e}generate(e){for(let o of e)m.assertValid(o);let t=[],r=e.map(o=>{let n=[],s=o.previousElementSibling,c=s!==null?Array.from(o.parentElement.children).indexOf(o):0,l=o.nextElementSibling,u=l!==null?Array.from(o.parentElement.children).length-Array.from(o.parentElement.children).indexOf(o):0;for(s===null?n.push({cost:(u+1)*1+100,level:0,type:"pseudo",selector:":first-child"}):n.push({cost:(c+1)*1+100,level:0,type:"pseudo",selector:":nth-child("+(c+1)+")"}),l===null?n.push({cost:(c+1)*1+100,level:0,type:"pseudo",selector:":last-child"}):c>0&&n.push({cost:(u+1)*1+100,level:0,type:"pseudo",selector:":nth-last-child("+u+")"}),s===null&&l===null&&n.push({cost:100,level:0,type:"pseudo",selector:":only-child"});s;){if(s.nodeType===Node.COMMENT_NODE){s=s.previousElementSibling;continue}if(s.nodeType===Node.TEXT_NODE){s=s.previousElementSibling;continue}let p=this.localGenerator.generate([s]);for(let a of p)n.some(f=>f.selector===":is("+a.selector+" ~ *)")||n.push({cost:105+a.cost,level:0,type:"pseudo",selector:":is("+a.selector+" ~ *)"});s=s.previousElementSibling}for(;l;){if(l.nodeType===Node.COMMENT_NODE){l=l.nextElementSibling;continue}if(l.nodeType===Node.TEXT_NODE){l=l.nextElementSibling;continue}let p=this.localGenerator.generate([l]);for(let a of p)n.some(f=>f.selector===":has(~ "+a.selector+")")||n.push({cost:105+a.cost,level:0,type:"pseudo",selector:":has(~ "+a.selector+")"});l=l.nextElementSibling}return n});if(r.length===0)return t;let i=r[0];for(let o of i)r.every(s=>s.some(c=>c.level===o.level&&c.type===o.type&&c.selector===o.selector))&&t.push(o);return t}};var P=class{constructor(e,t,r){this.localGenerator=e,this.exclusionGenerator=t,this.siblingGenerator=r}generate(e){for(let o of e)m.assertValid(o);let t=[],r=e.map(o=>{let n=[],s=o.parentElement,c=1;for(;s;){let l=this.localGenerator.generate([s]);for(let a of l)n.push({cost:c*1+10+a.cost,level:c,type:a.type,selector:a.selector});let u=this.exclusionGenerator.generate([s]);for(let a of u)n.push({cost:c*1+10+a.cost,level:c,type:a.type,selector:a.selector});let p=this.siblingGenerator.generate([s]);for(let a of p)n.push({cost:c*1+10+a.cost,level:c,type:a.type,selector:a.selector});s=s.parentElement,c=c+1}return n});if(r.length===0)return t;let i=r[0];for(let o of i)r.every(s=>s.some(c=>c.level===o.level&&c.type===o.type&&c.selector===o.selector))&&t.push(o);return t}};var X=class{constructor(){this.domService=new N,this.selectorBuilder=new V,this.bottomUpOptimizer=new R(this.domService,this.selectorBuilder),this.topDownOptimizer=new $(this.domService,this.selectorBuilder),this.localGenerator=new K,this.exclusionGenerator=new H(this.domService,this.localGenerator,this.selectorBuilder),this.childrenGenerator=new z(this.localGenerator),this.childrenExclusionGenerator=new k(this.domService,this.localGenerator,this.selectorBuilder),this.siblingGenerator=new U(this.localGenerator),this.parentGenerator=new P(this.localGenerator,this.exclusionGenerator,this.siblingGenerator)}getSelector(e){let t=Array.isArray(e)?e:[e];for(let n of t)m.assertValid(n);if(t.length>1){let n=t[0].ownerDocument;for(let s=1;s<t.length;s++)if(t[s].ownerDocument!==n)throw new Error("All elements must belong to the same document for multi-element selector generation")}let r=[];r=r.concat(this.localGenerator.generate(t)),r=r.concat(this.exclusionGenerator.generate(t)),r=r.concat(this.childrenGenerator.generate(t)),r=r.concat(this.siblingGenerator.generate(t)),r=r.concat(this.parentGenerator.generate(t)),r=r.concat(this.childrenExclusionGenerator.generate(t));let i=this.topDownOptimizer.findBest(t,r);return this.selectorBuilder.build(i)}};var te=function(){"use strict";let h=new X;return{getSelector:e=>h.getSelector(e)}}();typeof window<"u"&&(window.SelectorGenerator=te);})();
//# sourceMappingURL=selector-generator.min.js.map
